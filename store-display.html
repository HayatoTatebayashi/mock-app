<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>4ZERO-APP</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
        'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
    }
    /* 表の横スクロール対応 */
    .table-container {
      overflow-x: auto;
      overflow-y: auto;
      max-width: 100%;
      max-height: calc(100vh - 250px);
      -webkit-overflow-scrolling: touch;
      position: relative;
    }
    /* タブスタイル */
    .tab-container {
      border-bottom: 2px solid #e5e7eb;
      margin-bottom: 2rem;
    }
    .tab-list {
      display: flex;
      gap: 0;
      margin: 0;
      padding: 0;
      list-style: none;
    }
    .tab-button {
      padding: 0.5rem 1rem;
      background: #f3f4f6;
      border: none;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      font-size: 0.875rem;
      font-weight: 500;
      color: #6b7280;
      transition: all 0.2s;
    }
    .tab-button:hover {
      background: #e5e7eb;
      color: #374151;
    }
    .tab-button.active {
      background: white;
      color: #2e4265;
      border-bottom-color: #2e4265;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    /* スクロールバーのスタイル */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    ::-webkit-scrollbar-track {
      background: transparent;
    }
    ::-webkit-scrollbar-thumb {
      background: #d1d5db;
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #9ca3af;
    }
    /* Firefox用 */
    * {
      scrollbar-width: thin;
      scrollbar-color: #d1d5db transparent;
    }
    .table-container table {
      min-width: 1400px;
      width: 100%;
      table-layout: auto;
    }
    /* テーブルヘッダー固定 */
    .table-container thead {
      position: sticky;
      top: 0;
      z-index: 10;
      background: #f3f4f6;
    }
    .table-container thead tr:first-child {
      background: #f3f4f6;
    }
    .table-container thead tr:last-child {
      background: #f9fafb;
    }
    .table-container th,
    .table-container td {
      white-space: nowrap;
      font-size: 0.75rem;
    }
    /* 施設名列の幅制限 */
    .table-container th:first-child,
    .table-container td:first-child {
      max-width: 140px;
      min-width: 120px;
      white-space: normal;
      word-wrap: break-word;
    }
    @media (max-width: 1024px) {
      .table-container th,
      .table-container td {
        font-size: 0.7rem;
        padding: 0.375rem 0.5rem !important;
      }
    }
    /* ドロップダウンスタイル */
    .facility-dropdown {
      position: relative;
      min-height: 42px;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      padding: 0.5rem;
      background: white;
      cursor: pointer;
    }
    .facility-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      align-items: center;
    }
    .facility-tag {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      background: #3b82f6;
      color: white;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.875rem;
    }
    .facility-tag button {
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      padding: 0;
      margin-left: 0.25rem;
      font-weight: bold;
    }
    .facility-tag button:hover {
      opacity: 0.8;
    }
    .dropdown-menu {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      margin-top: 0.25rem;
      background: white;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      max-height: 300px;
      overflow-y: auto;
      z-index: 50;
      display: none;
    }
    .dropdown-menu.active {
      display: block;
    }
    .dropdown-group-title {
      padding: 0.5rem 0.75rem;
      font-weight: 600;
      background: #f3f4f6;
      color: #374151;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      cursor: pointer;
    }
    .dropdown-group-title input[type="checkbox"] {
      cursor: pointer;
    }
    .dropdown-group-title label {
      cursor: pointer;
      flex: 1;
    }
    .dropdown-item {
      padding: 0.5rem 0.75rem 0.5rem 2rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .dropdown-item:hover {
      background: #f3f4f6;
    }
    .dropdown-item input[type="checkbox"] {
      cursor: pointer;
    }
    .dropdown-item.hidden {
      display: none;
    }
    .area-facilities {
      display: block;
    }
    .area-facilities.collapsed {
      display: none;
    }
    .dropdown-actions {
      padding: 0.5rem 0.75rem;
      border-top: 1px solid #e5e7eb;
      display: flex;
      gap: 0.5rem;
    }
    /* タブスタイル */
    .tab-container {
      border-bottom: 2px solid #e5e7eb;
      margin-bottom: 1rem;
    }
    .tab-list {
      display: flex;
      gap: 0;
      margin: 0;
      padding: 0;
      list-style: none;
    }
    .tab-button {
      padding: 0.5rem 1rem;
      background: #f3f4f6;
      border: none;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      font-size: 0.875rem;
      font-weight: 500;
      color: #6b7280;
      transition: all 0.2s;
    }
    .tab-button:hover {
      background: #e5e7eb;
      color: #374151;
    }
    .tab-button.active {
      background: white;
      color: #2e4265;
      border-bottom-color: #2e4265;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    /* 日付単位ボタン */
    .date-unit-btn {
      padding: 0.375rem 0.75rem;
      background: white;
      border: none;
      border-right: 1px solid #d1d5db;
      cursor: pointer;
      font-size: 0.813rem;
      transition: all 0.2s;
    }
    .date-unit-btn:last-child {
      border-right: none;
    }
    .date-unit-btn:hover {
      background: #f3f4f6;
    }
    .date-unit-btn.active {
      background: #2563eb;
      color: white;
    }
    /* セクション折りたたみアイコン */
    .section-toggle-icon {
      font-size: 0.75rem;
      transition: transform 0.2s;
    }
    /* サイドバー開閉スタイル */
    .sidebar {
      transition: width 0.3s ease;
      width: 16rem;
      min-width: 16rem;
      position: fixed;
      left: 0;
      top: 64px;
      height: calc(100vh - 64px);
      overflow-y: auto;
      overflow-x: hidden;
      flex-shrink: 0;
      z-index: 100;
    }
    .sidebar.closed {
      width: 56px;
      min-width: 56px;
    }
    .content-wrapper {
      margin-left: 16rem;
      margin-top: 64px;
      transition: margin-left 0.3s ease;
      width: calc(100% - 16rem);
    }
    .sidebar.closed + .content-wrapper {
      margin-left: 56px;
      width: calc(100% - 56px);
    }
    .sidebar.closed nav {
      opacity: 0;
      pointer-events: none;
    }
    .sidebar-toggle {
      position: absolute;
      left: 8px;
      bottom: 16px;
      background: #2e4265;
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1001;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    .sidebar-toggle:hover {
      background: #3d5278;
      transform: scale(1.05);
    }
    /* 閉じた時のアイコンメニュー */
    .sidebar-icons {
      position: absolute;
      left: 0;
      top: 12px;
      width: 56px;
      display: none;
      flex-direction: column;
      gap: 12px;
      padding: 8px;
    }
    .sidebar.closed .sidebar-icons {
      display: flex;
    }
    .sidebar-icon-item {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: white;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      color: #2e4265;
    }
    .sidebar-icon-item:hover {
      background: #3d5278;
      color: white;
      transform: scale(1.05);
    }
    .sidebar-icon-item.active {
      background: #2e4265;
      color: white;
    }
    .main-content {
      flex: 1;
      transition: margin-left 0.3s ease;
    }
    /* レスポンシブ対応 */
    @media (max-width: 768px) {
      .sidebar {
        box-shadow: 2px 0 8px rgba(0,0,0,0.1);
      }
      .sidebar.closed {
        width: 0;
        min-width: 0;
      }
      .sidebar.closed .sidebar-icons {
        display: none;
      }
      .sidebar.closed .sidebar-toggle {
        left: 12px;
        top: 80px;
        position: fixed;
      }
      .content-wrapper {
        margin-left: 0 !important;
        width: 100% !important;
      }
      .main-content {
        padding: 1rem !important;
      }
      /* モバイルでのテーブルスクロール */
      .table-container {
        margin: 0 -1rem;
        padding: 0 1rem;
      }
    }
    @media (max-width: 1280px) {
      .table-container table th:first-child {
        position: sticky;
        left: 0;
        background: #f3f4f6;
        z-index: 10;
      }
      .table-container table td:first-child {
        position: sticky;
        left: 0;
        background: white;
        z-index: 10;
      }
      .table-container table tr:hover td:first-child {
        background: #f9fafb;
      }
    }
  </style>
</head>
<body class="min-h-screen bg-gray-50">
  <!-- ヘッダー -->
  <header class="bg-[#2e4265] text-white px-6 py-4 flex items-center justify-between h-16 fixed top-0 left-0 right-0 z-50">
    <div class="flex items-center gap-4">
      <button onclick="toggleSidebar()" class="md:hidden p-2 hover:bg-[#3d5278] rounded">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
      <h1 class="text-2xl font-bold">4ZERO-APP ※　中身はデモデータです。このURLは社外のユーザーに共有しないでください。</h1>
    </div>
    <div class="flex items-center gap-4">
      <div class="text-right">
        <div class="text-sm">山田 太郎</div>
        <div class="text-xs text-gray-300">user@squeeze.co.jp</div>
      </div>
      <button class="bg-white text-[#2e4265] px-4 py-2 rounded hover:bg-gray-100">
        管理画面
      </button>
    </div>
  </header>

  <!-- サイドバー -->
  <aside id="sidebar" class="sidebar w-32 bg-[#e8e8e8]">
      <!-- 開閉ボタン -->
      <button class="sidebar-toggle" onclick="toggleSidebar()">
        <svg id="sidebarIcon" class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
      </button>

      <!-- 閉じた時のアイコンメニュー -->
      <div class="sidebar-icons">
        <div class="sidebar-icon-item active" onclick="switchTab('dashboard')" title="ダッシュボード">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
          </svg>
        </div>
        <div class="sidebar-icon-item" onclick="switchTab('daily')" title="日次データ">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
          </svg>
        </div>
        <div class="sidebar-icon-item" onclick="switchTab('4zero')" title="月間サマリー">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
        </div>
        <div class="sidebar-icon-item" onclick="switchTab('monthly')" title="月間データ">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
        </div>
      </div>

      <nav>
        <!-- 4ZERO 親トグル -->
        <div class="mb-2">
          <button onclick="toggleFourZero()" class="w-full flex items-center justify-between p-3 hover:bg-gray-300 rounded font-bold">
            <span>4ZERO</span>
            <svg id="fourZeroIcon" class="w-4 h-4 transition-transform rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </button>

          <div id="fourZeroContent" class="ml-4 mt-1">
            <!-- 全施設 -->
            <div class="p-2 pl-4 font-semibold">
              全施設
            </div>

            <!-- 集計データ -->
            <a href="#" onclick="switchTab('daily'); return false;" class="block p-2 pl-4 hover:bg-gray-300 rounded ml-4 text-sm">
              集計データ
            </a>

            <!-- エリア別 -->
            <button onclick="toggleArea()" class="w-full flex items-center justify-between p-2 pl-4 hover:bg-gray-300 rounded">
              <span>エリア別</span>
              <svg id="areaIcon" class="w-4 h-4 transition-transform rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </button>

            <div id="areaContent" class="ml-4 mt-1">
                <!-- 北海道エリア -->
                <div>
                  <button onclick="toggleSidebarArea('hokkaido')" class="w-full flex items-center justify-between p-2 pl-4 hover:bg-gray-300 rounded text-sm">
                    <span>北海道</span>
                    <svg id="hokkaidoIcon" class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                    </svg>
                  </button>
                  <div id="hokkaidoContent" class="ml-4 hidden">
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 千歳</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn house Niseko Hirafu</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">FAV LUX 札幌すすきの</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 札幌大通 西18 Station</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 北広島 Station East</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">ES CON FIELD HOKKAIDO HOTEL Kitahiroshima Station</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">シアテル札幌</a>
                  </div>
                </div>

                <!-- 東京エリア -->
                <div>
                  <button onclick="toggleSidebarArea('tokyo')" class="w-full flex items-center justify-between p-2 pl-4 hover:bg-gray-300 rounded text-sm">
                    <span>東京</span>
                    <svg id="tokyoIcon" class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                    </svg>
                  </button>
                  <div id="tokyoContent" class="ml-4 hidden">
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 日本橋</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 浅草かっぱ橋</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 羽田エアポート</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 渋谷神山町</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 蒲田</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 上野新御徒町</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">シアテル羽田Ⅱ</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 浅草</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 上野入谷</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 秋葉原</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 西葛西</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 葛西</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 日本橋水天宮前</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 浅草蔵前 North</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 浅草蔵前 Station</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 上野</a>
                  </div>
                </div>

                <!-- 中部エリア -->
                <div>
                  <button onclick="toggleSidebarArea('chubu')" class="w-full flex items-center justify-between p-2 pl-4 hover:bg-gray-300 rounded text-sm">
                    <span>中部</span>
                    <svg id="chubuIcon" class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                    </svg>
                  </button>
                  <div id="chubuContent" class="ml-4 hidden">
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn STATION Ai Nagoya</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">カリオ笹塚</a>
                  </div>
                </div>

                <!-- 北陸エリア -->
                <div>
                  <button onclick="toggleSidebarArea('hokuriku')" class="w-full flex items-center justify-between p-2 pl-4 hover:bg-gray-300 rounded text-sm">
                    <span>北陸</span>
                    <svg id="hokurikuIcon" class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                    </svg>
                  </button>
                  <div id="hokurikuContent" class="ml-4 hidden">
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">tower eleven hotel</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 金沢</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">tower eleven onsen & sauna</a>
                  </div>
                </div>

                <!-- 京都エリア -->
                <div>
                  <button onclick="toggleSidebarArea('kyoto')" class="w-full flex items-center justify-between p-2 pl-4 hover:bg-gray-300 rounded text-sm">
                    <span>京都</span>
                    <svg id="kyotoIcon" class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                    </svg>
                  </button>
                  <div id="kyotoContent" class="ml-4 hidden">
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 四条大宮</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 河原町五条リバーサイド</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 祇園三条</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 清水五条</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 二条城</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 祇園</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 烏丸五条</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 祇園鴨川</a>
                  </div>
                </div>

                <!-- 大阪エリア -->
                <div>
                  <button onclick="toggleSidebarArea('osaka')" class="w-full flex items-center justify-between p-2 pl-4 hover:bg-gray-300 rounded text-sm">
                    <span>大阪</span>
                    <svg id="osakaIcon" class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                    </svg>
                  </button>
                  <div id="osakaContent" class="ml-4 hidden">
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 十三</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 北梅田</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 新大阪</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 東梅田</a>
                    <a href="#" class="block p-2 pl-4 hover:bg-gray-300 rounded text-xs">Minn 梅田中崎町</a>
                  </div>
                </div>
            </div>
          </div>
        </div>
      </nav>
    </aside>

  <!-- メインコンテンツ -->
  <div class="content-wrapper">
    <main class="main-content p-6">
      <div class="flex items-center justify-between mb-2">
        <h2 class="text-2xl font-bold"><span id="storeName">Minn 日本橋</span>： ダッシュボード</h2>

        <!-- 操作ボタン -->
        <div class="flex gap-4">
          <button onclick="openOvertimeModal()" class="text-sm border-2 px-3 py-2 rounded-md transition-colors font-medium" style="color: #4169e1; border-color: #4169e1;" onmouseover="this.style.backgroundColor='#f0f4ff'" onmouseout="this.style.backgroundColor='white'">
            残業入力
          </button>
          <button onclick="openComplaintModal()" class="text-sm bg-white border-2 px-3 py-2 rounded-md transition-colors font-medium" style="color: #f4a460; border-color: #f4a460;" onmouseover="this.style.backgroundColor='#fef6f0'" onmouseout="this.style.backgroundColor='white'">
            施設クレーム入力
          </button>
          <button onclick="openCleaningModal()" class="text-sm bg-white border-2 px-3 py-2 rounded-md transition-colors font-medium" style="color: #66cdaa; border-color: #66cdaa;" onmouseover="this.style.backgroundColor='#f0faf6'" onmouseout="this.style.backgroundColor='white'">
            清掃人数入力
          </button>
        </div>
      </div>

      <!-- タブナビゲーション -->
      <div class="tab-container">
        <div class="tab-list">
          <button class="tab-button active" onclick="switchTab('dashboard')">ダッシュボード</button>
          <button class="tab-button" onclick="switchTab('reviews')">クレーム・レビュー一覧</button>
          <button class="tab-button" onclick="switchTab('performance')">TrustYouパフォーマンス一覧</button>
        </div>
      </div>

      <!-- タブコンテンツ: ダッシュボード -->
      <section class="tab-content active" id="tab-dashboard">

      <!-- 当日の内容一覧 -->
      <div class="bg-white rounded-lg shadow px-6 py-3">
        <div class="flex items-center justify-between mb-4 pb-2 border-b-2 border-gray-300">
          <h3 class="text-xl font-bold">当日の内容一覧</h3>

          <!-- 日付選択 -->
          <div class="flex items-center gap-3">
            <button onclick="changeDate(-1)" class="p-2 hover:bg-gray-100 rounded-full transition-colors">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
              </svg>
            </button>
            <input type="date" id="selectedDate" class="border border-gray-300 rounded-lg px-4 py-2 text-sm font-medium" onchange="loadDateData()">
            <button onclick="changeDate(1)" class="p-2 hover:bg-gray-100 rounded-full transition-colors">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </button>
            <button onclick="setToday()" class="bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-600 transition-colors">
              今日
            </button>
          </div>
        </div>

        <!-- 売止め数 -->
        <div class="mb-6">
          <div class="flex items-center justify-between mb-3">
            <h4 class="text-lg font-semibold flex items-center gap-2">
              <span class="w-1 h-6 bg-blue-500"></span>
              売止め数
            </h4>
            <div class="flex items-baseline gap-2">
              <span class="text-sm text-gray-600">合計:</span>
              <span class="text-2xl font-bold text-blue-600" id="uridome-total">4件</span>
              <span class="text-xs text-gray-500">(前月平均: 4.0件/日)</span>
            </div>
          </div>
          <div class="grid grid-cols-2 gap-4 ml-4">
            <div class="bg-gray-50 p-4 rounded-lg">
              <div class="text-sm text-gray-600 mb-1">清掃</div>
              <div class="flex items-baseline gap-2">
                <div class="text-2xl font-bold text-blue-600" id="uridome-clean">3件</div>
                <div class="text-sm text-gray-500">前月平均: 2.8件</div>
              </div>
            </div>
            <div class="bg-gray-50 p-4 rounded-lg">
              <div class="text-sm text-gray-600 mb-1">設備・その他</div>
              <div class="flex items-baseline gap-2">
                <div class="text-2xl font-bold text-blue-600" id="uridome-other">1件</div>
                <div class="text-sm text-gray-500">前月平均: 1.2件</div>
              </div>
            </div>
          </div>
        </div>

        <!-- 残業 -->
        <div class="mb-6">
          <div class="flex items-center justify-between mb-3">
            <h4 class="text-lg font-semibold flex items-center gap-2">
              <span class="w-1 h-6 bg-indigo-500"></span>
              残業
            </h4>
            <div class="flex items-baseline gap-2">
              <span class="text-sm text-gray-600">合計:</span>
              <span class="text-2xl font-bold text-indigo-600" id="overtime-total">3.5時間</span>
              <span class="text-xs text-gray-500">(前月平均: 2.5時間/日)</span>
            </div>
          </div>
          <div class="ml-4 space-y-3" id="overtimeList">
            <div class="border border-gray-200 rounded-lg p-4">
              <div class="flex justify-between items-start mb-2">
                <div class="flex gap-4">
                  <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded text-sm font-medium">早番</span>
                  <span class="font-semibold">山田太郎</span>
                </div>
                <span class="text-lg font-bold text-indigo-600">2.5時間</span>
              </div>
              <div class="text-sm text-gray-600 bg-gray-50 p-2 rounded">
                理由: チェックイン対応の遅延により残業
              </div>
            </div>
            <div class="border border-gray-200 rounded-lg p-4">
              <div class="flex justify-between items-start mb-2">
                <div class="flex gap-4">
                  <span class="bg-green-100 text-green-800 px-3 py-1 rounded text-sm font-medium">中番</span>
                  <span class="font-semibold">佐藤花子</span>
                </div>
                <span class="text-lg font-bold text-indigo-600">1.0時間</span>
              </div>
              <div class="text-sm text-gray-600 bg-gray-50 p-2 rounded">
                理由: 清掃スタッフ不足のため
              </div>
            </div>
          </div>
        </div>

        <!-- クレーム -->
        <div class="mb-6">
          <div class="flex items-center justify-between mb-3">
            <h4 class="text-lg font-semibold flex items-center gap-2">
              <span class="w-1 h-6 bg-rose-500"></span>
              クレーム
            </h4>
            <div class="flex items-baseline gap-2">
              <span class="text-sm text-gray-600">件数:</span>
              <span class="text-2xl font-bold text-rose-600" id="complaintCount">2件</span>
              <span class="text-xs text-gray-500">(前月平均: 1.8件/日)</span>
            </div>
          </div>
          <div class="ml-4 space-y-3" id="complaintList">
            <div class="border border-rose-200 bg-rose-50 rounded-lg p-4">
              <div class="flex justify-between items-start mb-2">
                <div class="font-semibold text-rose-900">部屋の清掃不備</div>
                <span class="bg-orange-100 text-orange-800 px-2 py-1 rounded text-xs font-medium">電話</span>
              </div>
              <div class="text-sm text-gray-700 mb-1">クレーム者: 田中様</div>
              <div class="text-sm text-gray-600 bg-white p-2 rounded">
                浴室の髪の毛が残っていた。すぐに清掃対応を実施。
              </div>
            </div>
            <div class="border border-rose-200 bg-rose-50 rounded-lg p-4">
              <div class="flex justify-between items-start mb-2">
                <div class="font-semibold text-rose-900">Wi-Fiが繋がらない</div>
                <span class="bg-orange-100 text-orange-800 px-2 py-1 rounded text-xs font-medium">直接</span>
              </div>
              <div class="text-sm text-gray-700 mb-1">クレーム者: 鈴木様</div>
              <div class="text-sm text-gray-600 bg-white p-2 rounded">
                ルーター再起動で解決。お詫びの品を提供。
              </div>
            </div>
          </div>
        </div>

        <!-- 清掃基準値 -->
        <div class="mb-6">
          <div class="flex items-center justify-between mb-3">
            <h4 class="text-lg font-semibold flex items-center gap-2">
              <span class="w-1 h-6 bg-emerald-500"></span>
              清掃基準値
            </h4>
            <div class="flex items-baseline gap-2">
              <span class="text-sm text-gray-600">達成率:</span>
              <span class="text-2xl font-bold text-emerald-600" id="cleaning-achievement-rate">95.8%</span>
              <span class="text-xs text-green-600" id="cleaning-achievement-diff">↑ +3.2%</span>
            </div>
          </div>
          <div class="ml-4">
            <div class="bg-gray-50 p-4 rounded-lg mb-4">
              <div class="text-sm text-gray-600 mb-1">総清掃数（室）</div>
              <div class="flex items-baseline gap-2">
                <div class="text-2xl font-bold text-emerald-600" id="totalRooms">24室</div>
                <div class="text-sm text-gray-500">前月平均: 22.5室</div>
              </div>
            </div>
            <div class="grid grid-cols-3 gap-4">
              <div class="border border-gray-200 rounded-lg p-4">
                <div class="text-sm text-gray-600 mb-1">早番</div>
                <div class="flex items-baseline gap-2">
                  <div class="text-xl font-bold text-emerald-600" id="cleaning-morning">3人</div>
                  <div class="text-xs text-gray-500">前月: 2.8人</div>
                </div>
                <div class="text-xs text-gray-500 mt-1">入力者: 管理者</div>
              </div>
              <div class="border border-gray-200 rounded-lg p-4">
                <div class="text-sm text-gray-600 mb-1">中番</div>
                <div class="flex items-baseline gap-2">
                  <div class="text-xl font-bold text-emerald-600" id="cleaning-day">2人</div>
                  <div class="text-xs text-gray-500">前月: 2.1人</div>
                </div>
                <div class="text-xs text-gray-500 mt-1">入力者: 管理者</div>
              </div>
              <div class="border border-gray-200 rounded-lg p-4">
                <div class="text-sm text-gray-600 mb-1">スポット</div>
                <div class="flex items-baseline gap-2">
                  <div class="text-xl font-bold text-emerald-600" id="cleaning-spot">1人</div>
                  <div class="text-xs text-gray-500">前月: 0.9人</div>
                </div>
                <div class="text-xs text-gray-500 mt-1">入力者: 管理者</div>
              </div>
            </div>
          </div>
        </div>

      </div>

      </section>

      <!-- タブコンテンツ: クレーム・レビュー一覧 -->
      <section class="tab-content" id="tab-reviews">

        <!-- 統計情報 -->
        <div class="bg-white rounded-lg shadow mb-6 p-6">
          <div class="flex items-center justify-between mb-4 pb-2 border-b-2 border-gray-300">
            <h3 class="text-xl font-bold">クレーム・レビュー統計</h3>
            <div class="flex items-center gap-3">
              <label class="text-sm text-gray-600">表示月:</label>
              <select id="month-filter" onchange="filterByMonth()" class="border border-gray-300 rounded-lg px-3 py-1 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-blue-500">
                <!-- JavaScript で動的に生成 -->
              </select>
            </div>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
            <div class="text-center">
              <div class="text-sm text-gray-600 mb-1">施設クレーム数</div>
              <div class="text-3xl font-bold text-orange-600" id="total-complaints">5</div>
              <div class="text-xs mt-1" id="total-complaints-diff">
                <span class="text-orange-600">↑ +2 (66.7%)</span>
              </div>
            </div>
            <div class="text-center">
              <div class="text-sm text-gray-600 mb-1">総レビュー数</div>
              <div class="text-3xl font-bold text-blue-600" id="total-reviews">50</div>
              <div class="text-xs mt-1" id="total-reviews-diff">
                <span class="text-green-600">↑ +5 (11.1%)</span>
              </div>
            </div>
            <div class="text-center">
              <div class="text-sm text-gray-600 mb-1">平均スコア</div>
              <div class="text-3xl font-bold text-green-600" id="avg-score">75.2</div>
              <div class="text-xs mt-1" id="avg-score-diff">
                <span class="text-green-600">↑ +2.3pt</span>
              </div>
            </div>
            <div class="text-center">
              <div class="text-sm text-gray-600 mb-1">高評価（90点以上）</div>
              <div class="text-3xl font-bold text-green-600" id="high-reviews">23</div>
              <div class="text-xs mt-1" id="high-reviews-diff">
                <span class="text-green-600">↑ +3 (15.0%)</span>
              </div>
            </div>
            <div class="text-center">
              <div class="text-sm text-gray-600 mb-1">低評価（60点未満）</div>
              <div class="text-3xl font-bold text-red-600" id="low-reviews">5</div>
              <div class="text-xs mt-1" id="low-reviews-diff">
                <span class="text-red-600">↑ +2 (66.7%)</span>
              </div>
            </div>
          </div>
        </div>

        <!-- クレーム一覧セクション -->
        <div class="bg-white rounded-lg shadow mb-6 p-6">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-xl font-bold">クレーム一覧</h3>
            <div class="flex items-center gap-3">
              <input type="date" id="complaint-date-from" class="border border-gray-300 rounded-lg px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
              <span class="text-sm text-gray-600">〜</span>
              <input type="date" id="complaint-date-to" class="border border-gray-300 rounded-lg px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
              <button onclick="filterComplaints()" class="bg-blue-600 text-white px-4 py-1 rounded-lg hover:bg-blue-700 text-sm font-medium">絞り込み</button>
            </div>
          </div>

          <div class="overflow-x-auto" style="max-height: 300px; overflow-y: auto;">
            <table class="min-w-full divide-y divide-gray-200">
              <thead style="background-color: #f3f4f6; position: sticky; top: 0; z-index: 10;">
                <tr>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-700 tracking-wider whitespace-nowrap">発生日時</th>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-700 tracking-wider whitespace-nowrap">部屋名</th>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-700 tracking-wider whitespace-nowrap">経由</th>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-700 tracking-wider">タイトル</th>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-700 tracking-wider">内容</th>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-700 tracking-wider">対応</th>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-700 tracking-wider whitespace-nowrap">担当者</th>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-700 tracking-wider whitespace-nowrap">ステータス</th>
                  <th class="px-3 py-2 text-center text-xs font-medium text-gray-700 tracking-wider whitespace-nowrap">入力</th>
                </tr>
              </thead>
              <tbody class="bg-white divide-y divide-gray-200" id="complaints-tbody">
                <!-- データはJavaScriptで生成 -->
              </tbody>
            </table>
          </div>

          <!-- ページネーション -->
          <div class="bg-gray-50 px-4 py-3 border-t border-gray-200 mt-4">
            <div class="flex items-center justify-between">
              <div class="text-sm text-gray-700">
                <span class="font-medium" id="complaint-displayed-count">10</span> 件表示中（全 <span class="font-medium" id="complaint-total-count">50</span> 件）
              </div>
              <div class="flex gap-2">
                <button onclick="changeComplaintPage(-1)" class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50">
                  前へ
                </button>
                <span class="px-3 py-1 text-sm bg-blue-600 text-white rounded" id="complaint-current-page">1</span>
                <button onclick="changeComplaintPage(1)" class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50">
                  次へ
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- TrustYouレビューテーブル -->
        <div class="bg-white rounded-lg shadow overflow-hidden">
          <div class="px-6 py-4 border-b border-gray-200">
            <h3 class="text-xl font-bold">TrustYouレビュー</h3>
          </div>
          <div class="overflow-x-auto" style="max-height: 450px; overflow-y: auto;">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50" style="position: sticky; top: 0; z-index: 10;">
                <tr>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap bg-gray-50">ID</th>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap bg-gray-50">日付</th>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap bg-gray-50">施設</th>
                  <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap bg-gray-50">スコア</th>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap bg-gray-50">サイト</th>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50">タイトル</th>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50">訳文</th>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50">原文</th>
                  <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap bg-gray-50">返信済み</th>
                  <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap bg-gray-50">返信担当者</th>
                </tr>
              </thead>
              <tbody class="bg-white divide-y divide-gray-200" id="reviews-tbody">
                <!-- データはJavaScriptで生成 -->
              </tbody>
            </table>
          </div>

          <!-- ページネーション -->
          <div class="bg-gray-50 px-4 py-3 border-t border-gray-200">
            <div class="flex items-center justify-between">
              <div class="text-sm text-gray-700">
                <span class="font-medium" id="displayed-count">50</span> 件表示中（全 <span class="font-medium" id="total-count">50</span> 件）
              </div>
              <div class="flex gap-2">
                <button onclick="previousPage()" id="prev-btn" class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
                  前へ
                </button>
                <span class="px-3 py-1 text-sm bg-blue-600 text-white rounded" id="current-page">1</span>
                <button onclick="nextPage()" id="next-btn" class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
                  次へ
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- タブコンテンツ: TrustYouパフォーマンス一覧 -->
      <section class="tab-content" id="tab-performance">
        <div class="bg-white rounded-lg shadow px-6 py-3">
          <h3 class="text-xl font-bold mb-4">TrustYouパフォーマンス一覧</h3>

          <!-- パフォーマンステーブル -->
          <div class="overflow-x-auto max-h-[600px] overflow-y-auto">
            <table class="min-w-full divide-y divide-gray-200 text-xs">
              <thead class="sticky top-0 z-10" style="background-color: #f3f4f6;">
                <tr>
                  <th rowspan="2" class="px-3 py-2 text-left font-medium whitespace-nowrap border-r border-gray-300 text-gray-700 sticky left-0 z-20" style="background-color: #f3f4f6;">日付</th>
                  <th rowspan="2" class="px-3 py-2 text-left font-medium whitespace-nowrap border-r border-gray-300 text-gray-700 sticky left-[100px] z-20" style="background-color: #f3f4f6;">施設</th>
                  <th colspan="2" class="px-3 py-2 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">TrustYou</th>
                  <th colspan="2" class="px-3 py-2 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">Google</th>
                  <th colspan="2" class="px-3 py-2 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">Booking.com</th>
                  <th colspan="2" class="px-3 py-2 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">Expedia</th>
                  <th colspan="2" class="px-3 py-2 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">trip.com</th>
                  <th colspan="2" class="px-3 py-2 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">Agoda</th>
                  <th colspan="2" class="px-3 py-2 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">Rakuten Travel</th>
                  <th colspan="2" class="px-3 py-2 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">Jalan.net</th>
                  <th colspan="2" class="px-3 py-2 text-center font-medium whitespace-nowrap text-gray-700" style="background-color: #f3f4f6;">Airbnb</th>
                </tr>
                <tr>
                  <!-- TrustYou -->
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">実数</th>
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">前月差</th>
                  <!-- Google -->
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">実数</th>
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">前月差</th>
                  <!-- Booking.com -->
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">実数</th>
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">前月差</th>
                  <!-- Expedia -->
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">実数</th>
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">前月差</th>
                  <!-- trip.com -->
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">実数</th>
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">前月差</th>
                  <!-- Agoda -->
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">実数</th>
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">前月差</th>
                  <!-- Rakuten Travel -->
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">実数</th>
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">前月差</th>
                  <!-- Jalan.net -->
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">実数</th>
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">前月差</th>
                  <!-- Airbnb -->
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap border-r border-gray-300 text-gray-700" style="background-color: #f3f4f6;">実数</th>
                  <th class="px-2 py-1 text-center font-medium whitespace-nowrap text-gray-700" style="background-color: #f3f4f6;">前月差</th>
                </tr>
              </thead>
              <tbody class="bg-white divide-y divide-gray-200" id="performance-tbody">
                <!-- データはJavaScriptで生成 -->
              </tbody>
            </table>
          </div>

          <!-- ページネーション -->
          <div class="bg-gray-50 px-4 py-3 border-t border-gray-200 sm:px-6 mt-4">
            <div class="flex items-center justify-between">
              <div class="text-sm text-gray-700">
                <span class="font-medium" id="performance-displayed-count">50</span> 件表示中
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- タブコンテンツ: 集計データ -->
      <section class="tab-content" id="tab-daily">
        <div class="bg-white rounded-lg shadow px-6 py-3">
          <h3 class="text-xl font-bold mb-4">集計データ</h3>
          <p class="text-gray-600">集計データの内容がここに表示されます。</p>
        </div>
      </section>

    </main>
  </div>

  <!-- 残業入力モーダル -->
  <div id="overtimeModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-md mx-4">
      <div class="text-white px-6 py-4 rounded-t-lg flex items-center justify-between" style="background-color: #4169e1;">
        <h3 class="text-xl font-bold">残業入力</h3>
        <button onclick="closeOvertimeModal()" class="text-white hover:text-gray-200">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
      <div class="p-6">
        <form id="overtimeForm">
          <div class="mb-4">
            <label class="block text-gray-700 font-semibold mb-2">名前</label>
            <input type="text" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="名前を入力">
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 font-semibold mb-2">時間帯</label>
            <select class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
              <option value="">選択してください</option>
              <option value="morning">早番</option>
              <option value="day">中番</option>
              <option value="evening">遅番</option>
            </select>
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 font-semibold mb-2">時間（時間）</label>
            <input type="number" step="0.5" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="例: 2.5">
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 font-semibold mb-2">理由</label>
            <textarea class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" rows="3" placeholder="残業理由を入力"></textarea>
          </div>
          <div class="flex gap-3">
            <button type="submit" class="flex-1 text-white px-4 py-2 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all" style="background-color: #4169e1;" onmouseover="this.style.opacity='0.9'" onmouseout="this.style.opacity='1'">
              登録
            </button>
            <button type="button" onclick="closeOvertimeModal()" class="flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 font-semibold">
              キャンセル
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- 施設クレームモーダル -->
  <div id="complaintModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center" style="display: none; z-index: 9999;">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-6xl mx-8 my-2" style="max-height: 98vh; overflow-y: auto;">
      <div class="text-white px-6 py-2 rounded-t-lg flex items-center justify-between sticky top-0" style="background-color: #f4a460; z-index: 10000;">
        <h3 class="text-lg font-bold">施設クレーム</h3>
        <button onclick="closeComplaintModal()" class="text-white hover:text-gray-200">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
      <div class="px-6 py-3">
        <form id="complaintForm">
          <div class="grid grid-cols-2 gap-4 mb-2">
            <div>
              <label class="block text-gray-700 font-semibold mb-1 text-xs">タイトル</label>
              <input type="text" id="complaint-title" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-1 focus:ring-orange-500" placeholder="タイトルを入力">
            </div>
            <div>
              <label class="block text-gray-700 font-semibold mb-1 text-xs">経由</label>
              <input type="text" id="complaint-source" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-1 focus:ring-orange-500" placeholder="例: 電話、メール、直接">
            </div>
          </div>
          <div class="grid grid-cols-3 gap-4 mb-2">
            <div>
              <label class="block text-gray-700 font-semibold mb-1 text-xs">部屋名</label>
              <select id="complaint-room" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-1 focus:ring-orange-500">
                <option value="">選択してください</option>
                <option value="桜">桜</option>
                <option value="梅">梅</option>
                <option value="松">松</option>
                <option value="竹">竹</option>
                <option value="菊">菊</option>
                <option value="藤">藤</option>
                <option value="蘭">蘭</option>
                <option value="椿">椿</option>
                <option value="桔梗">桔梗</option>
                <option value="楓">楓</option>
              </select>
            </div>
            <div>
              <label class="block text-gray-700 font-semibold mb-1 text-xs">ステータス</label>
              <select id="complaint-status" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-1 focus:ring-orange-500">
                <option value="対応中">対応中</option>
                <option value="対応完了">対応完了</option>
              </select>
            </div>
          </div>
          <div class="mb-2">
            <label class="block text-gray-700 font-semibold mb-1 text-xs">応対者</label>
            <input type="text" id="complaint-staff" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-1 focus:ring-orange-500" placeholder="応対者名を入力">
          </div>
          <div class="mb-2">
            <label class="block text-gray-700 font-semibold mb-1 text-xs">内容</label>
            <textarea id="complaint-content" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-1 focus:ring-orange-500" rows="4" placeholder="クレーム内容を入力"></textarea>
          </div>
          <div class="mb-2">
            <label class="block text-gray-700 font-semibold mb-1 text-xs">対応</label>
            <textarea id="complaint-response" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-1 focus:ring-orange-500" rows="4" placeholder="対応内容を入力"></textarea>
          </div>
          <div class="mb-2">
            <label class="block text-gray-700 font-semibold mb-1 text-xs">発生原因</label>
            <textarea id="complaint-cause" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-1 focus:ring-orange-500" rows="4" placeholder="なしなら無記入でOK！&#10;発生原因を入力"></textarea>
          </div>
          <div class="mb-2">
            <label class="block text-gray-700 font-semibold mb-1 text-xs">今後改善対策</label>
            <textarea id="complaint-improvement" class="w-full border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-1 focus:ring-orange-500" rows="4" placeholder="なしなら無記入でOK！&#10;今後の改善対策を入力"></textarea>
          </div>
          <div class="flex gap-3 mt-3">
            <button type="submit" class="flex-1 text-white px-4 py-2 rounded font-semibold text-sm shadow-md hover:shadow-lg transition-all" style="background-color: #f4a460;" onmouseover="this.style.opacity='0.9'" onmouseout="this.style.opacity='1'">
              登録
            </button>
            <button type="button" onclick="closeComplaintModal()" class="flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400 font-semibold text-sm">
              キャンセル
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- 清掃人数入力モーダル -->
  <div id="cleaningModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-md mx-4">
      <div class="text-white px-6 py-4 rounded-t-lg flex items-center justify-between" style="background-color: #66cdaa;">
        <h3 class="text-xl font-bold">清掃人数入力</h3>
        <button onclick="closeCleaningModal()" class="text-white hover:text-gray-200">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
      <div class="p-6">
        <form id="cleaningForm">
          <div class="mb-4">
            <label class="block text-gray-700 font-semibold mb-2">早番（人）</label>
            <input type="number" min="0" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="例: 3">
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 font-semibold mb-2">中番（人）</label>
            <input type="number" min="0" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="例: 2">
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 font-semibold mb-2">スポット（人）</label>
            <input type="number" min="0" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="例: 1">
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 font-semibold mb-2">名前</label>
            <input type="text" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="名前を入力">
          </div>
          <div class="flex gap-3">
            <button type="submit" class="flex-1 text-white px-4 py-2 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all" style="background-color: #66cdaa;" onmouseover="this.style.opacity='0.9'" onmouseout="this.style.opacity='1'">
              登録
            </button>
            <button type="button" onclick="closeCleaningModal()" class="flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 font-semibold">
              キャンセル
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    // サイドバーの開閉
    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      const icon = document.getElementById('sidebarIcon');
      sidebar.classList.toggle('closed');

      // アイコンの向きを変更
      if (sidebar.classList.contains('closed')) {
        icon.style.transform = 'rotate(180deg)';
      } else {
        icon.style.transform = 'rotate(0deg)';
      }
    }

    // 4ZEROセクションの折りたたみ
    function toggleFourZero() {
      const content = document.getElementById('fourZeroContent');
      const icon = document.getElementById('fourZeroIcon');
      content.classList.toggle('hidden');
      icon.classList.toggle('rotate-90');
    }

    // エリア別セクションの折りたたみ
    function toggleArea() {
      const content = document.getElementById('areaContent');
      const icon = document.getElementById('areaIcon');
      content.classList.toggle('hidden');
      icon.classList.toggle('rotate-90');
    }

    // サイドバーエリアの折りたたみ
    function toggleSidebarArea(area) {
      const content = document.getElementById(area + 'Content');
      const icon = document.getElementById(area + 'Icon');
      content.classList.toggle('hidden');
      icon.classList.toggle('rotate-90');
    }

    // タブ切り替え
    function switchTab(tabName) {
      // 全てのタブボタンとコンテンツからactiveクラスを削除
      document.querySelectorAll('.tab-button').forEach(button => {
        button.classList.remove('active');
      });
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
      });

      // クリックされたタブボタンとコンテンツにactiveクラスを追加
      event.target.classList.add('active');
      document.getElementById('tab-' + tabName).classList.add('active');
    }

    // モーダル開閉機能
    function openOvertimeModal() {
      const modal = document.getElementById('overtimeModal');
      modal.classList.remove('hidden');
      modal.classList.add('flex');
    }

    function closeOvertimeModal() {
      const modal = document.getElementById('overtimeModal');
      modal.classList.add('hidden');
      modal.classList.remove('flex');
      document.getElementById('overtimeForm').reset();
    }


    function openCleaningModal() {
      const modal = document.getElementById('cleaningModal');
      modal.classList.remove('hidden');
      modal.classList.add('flex');
    }

    function closeCleaningModal() {
      const modal = document.getElementById('cleaningModal');
      modal.classList.add('hidden');
      modal.classList.remove('flex');
      document.getElementById('cleaningForm').reset();
    }

    // フォーム送信処理
    document.getElementById('overtimeForm').addEventListener('submit', function(e) {
      e.preventDefault();
      alert('残業情報を登録しました');
      closeOvertimeModal();
    });

    document.getElementById('complaintForm').addEventListener('submit', function(e) {
      e.preventDefault();
      alert('クレーム情報を登録しました');
      closeComplaintModal();
    });

    document.getElementById('cleaningForm').addEventListener('submit', function(e) {
      e.preventDefault();
      alert('清掃人数を登録しました');
      closeCleaningModal();
    });

    // モーダル外クリックで閉じる
    window.addEventListener('click', function(e) {
      if (e.target.id === 'overtimeModal') {
        closeOvertimeModal();
      }
      if (e.target.id === 'complaintModal') {
        closeComplaintModal();
      }
      if (e.target.id === 'cleaningModal') {
        closeCleaningModal();
      }
    });

    // 日付関連機能
    function setToday() {
      const today = new Date();
      const dateStr = today.toISOString().split('T')[0];
      document.getElementById('selectedDate').value = dateStr;
      loadDateData();
    }

    function changeDate(days) {
      const dateInput = document.getElementById('selectedDate');
      const currentDate = new Date(dateInput.value || new Date());
      currentDate.setDate(currentDate.getDate() + days);
      dateInput.value = currentDate.toISOString().split('T')[0];
      loadDateData();
    }

    function loadDateData() {
      const selectedDate = document.getElementById('selectedDate').value;
      console.log('Loading data for date:', selectedDate);

      // ここで選択された日付のデータを読み込む（APIコール等）
      // モックデータの例
      updateMockData(selectedDate);
    }

    function updateMockData(date) {
      // 日付に応じてランダムなモックデータを生成（実際にはAPIから取得）
      const dateObj = new Date(date);
      const dayOfMonth = dateObj.getDate();

      // 売止め数を更新
      document.getElementById('uridome-clean').textContent = (2 + dayOfMonth % 4) + '件';
      document.getElementById('uridome-other').textContent = (dayOfMonth % 3) + '件';

      // 残業データを更新
      const overtimeList = document.getElementById('overtimeList');
      const overtimeCount = 1 + (dayOfMonth % 3);
      overtimeList.innerHTML = generateOvertimeHTML(overtimeCount, dayOfMonth);

      // クレームデータを更新
      const complaintList = document.getElementById('complaintList');
      const complaintCount = dayOfMonth % 4;
      document.getElementById('complaintCount').textContent = complaintCount + '件';
      complaintList.innerHTML = generateComplaintHTML(complaintCount, dayOfMonth);

      // 清掃データを更新
      document.getElementById('totalRooms').textContent = (20 + dayOfMonth % 10) + '室';
      document.getElementById('cleaning-morning').textContent = (2 + dayOfMonth % 3) + '人';
      document.getElementById('cleaning-day').textContent = (1 + dayOfMonth % 3) + '人';
      document.getElementById('cleaning-spot').textContent = (dayOfMonth % 2) + '人';
    }

    function generateOvertimeHTML(count, seed) {
      if (count === 0) return '<p class="text-gray-500">残業データなし</p>';

      const names = ['山田太郎', '佐藤花子', '鈴木一郎', '田中美咲'];
      const shifts = ['早番', '中番', '遅番'];
      const reasons = [
        'チェックイン対応の遅延により残業',
        '清掃スタッフ不足のため',
        '急な予約対応のため',
        'トラブル対応のため'
      ];
      const shiftColors = {
        '早番': 'bg-blue-100 text-blue-800',
        '中番': 'bg-green-100 text-green-800',
        '遅番': 'bg-purple-100 text-purple-800'
      };

      let html = '';
      for (let i = 0; i < count; i++) {
        const shift = shifts[(seed + i) % 3];
        const name = names[(seed + i) % names.length];
        const hours = (1 + ((seed + i) % 4) * 0.5).toFixed(1);
        const reason = reasons[(seed + i) % reasons.length];

        html += `
          <div class="border border-gray-200 rounded-lg p-4">
            <div class="flex justify-between items-start mb-2">
              <div class="flex gap-4">
                <span class="${shiftColors[shift]} px-3 py-1 rounded text-sm font-medium">${shift}</span>
                <span class="font-semibold">${name}</span>
              </div>
              <span class="text-lg font-bold text-indigo-600">${hours}時間</span>
            </div>
            <div class="text-sm text-gray-600 bg-gray-50 p-2 rounded">
              理由: ${reason}
            </div>
          </div>
        `;
      }
      return html;
    }

    function generateComplaintHTML(count, seed) {
      if (count === 0) return '<p class="text-gray-500">クレームなし</p>';

      const titles = ['部屋の清掃不備', 'Wi-Fiが繋がらない', '騒音の苦情', '設備の故障'];
      const channels = ['電話', 'メール', '直接', '予約サイト'];
      const customers = ['田中様', '鈴木様', '佐藤様', '山本様'];
      const contents = [
        '浴室の髪の毛が残っていた。すぐに清掃対応を実施。',
        'ルーター再起動で解決。お詫びの品を提供。',
        '隣室への注意喚起を実施。',
        '修理業者を手配。代替品を提供。'
      ];

      let html = '';
      for (let i = 0; i < count; i++) {
        const title = titles[(seed + i) % titles.length];
        const channel = channels[(seed + i) % channels.length];
        const customer = customers[(seed + i) % customers.length];
        const content = contents[(seed + i) % contents.length];

        html += `
          <div class="border border-rose-200 bg-rose-50 rounded-lg p-4">
            <div class="flex justify-between items-start mb-2">
              <div class="font-semibold text-rose-900">${title}</div>
              <span class="bg-orange-100 text-orange-800 px-2 py-1 rounded text-xs font-medium">${channel}</span>
            </div>
            <div class="text-sm text-gray-700 mb-1">クレーム者: ${customer}</div>
            <div class="text-sm text-gray-600 bg-white p-2 rounded">
              ${content}
            </div>
          </div>
        `;
      }
      return html;
    }

    // TrustYouレビューデータ生成
    let currentReviewPage = 1;
    const reviewsPerPage = 50;
    let allReviews = []; // 全レビューデータを保持

    function generateMockReviews(count, facilityName, monthsBack = 6) {
      const reviews = [];
      const sites = ['Google', 'Booking.com', 'TripAdvisor', 'じゃらん', '楽天トラベル'];
      const names = ['田中太郎', '佐藤花子', '鈴木一郎', '高橋美咲', '渡辺健太', '伊藤さくら', '山本大輔', '中村由美', '小林誠', '加藤麻衣'];
      const titles = [
        '素晴らしい滞在でした',
        '快適なホテル',
        '立地が最高',
        'スタッフの対応が良い',
        '清潔な部屋',
        '朝食が美味しい',
        '景色が綺麗',
        'また泊まりたい',
        'コスパが良い',
        'アクセス便利'
      ];
      const reviews_ja = [
        '部屋が清潔で快適でした。スタッフの対応も素晴らしく、また利用したいと思います。',
        'ロケーションが良く、観光に便利でした。朝食のバリエーションも豊富で満足です。',
        '施設が新しく、アメニティも充実していました。次回もぜひ利用させていただきます。',
        'チェックイン・チェックアウトがスムーズで助かりました。',
        '価格以上のサービスを受けられました。コストパフォーマンスが高いです。'
      ];
      const reviews_en = [
        'The room was clean and comfortable. The staff was wonderful and I would like to use it again.',
        'Good location and convenient for sightseeing. Breakfast was also varied and satisfactory.',
        'The facility was new and the amenities were well-stocked. I will definitely use it again next time.',
        'Check-in and check-out were smooth and helpful.',
        'I received service beyond the price. Great cost performance.'
      ];

      // 過去monthsBack月分のレビューを生成
      const totalReviews = count * monthsBack;
      for (let i = 0; i < totalReviews; i++) {
        const date = new Date();
        date.setMonth(date.getMonth() - Math.floor(i / count));
        date.setDate(Math.floor(Math.random() * 28) + 1);
        const score = Math.floor(Math.random() * 50) + 50; // 50-100
        const titleIdx = Math.floor(Math.random() * titles.length);
        const reviewIdx = Math.floor(Math.random() * reviews_ja.length);

        reviews.push({
          id: `REV${String(i + 1).padStart(5, '0')}`,
          date: date.toISOString().split('T')[0],
          facility: facilityName,
          score: score,
          site: sites[Math.floor(Math.random() * sites.length)],
          name: names[Math.floor(Math.random() * names.length)],
          dataType: 'レビュー',
          title: titles[titleIdx],
          translation: reviews_ja[reviewIdx],
          original: reviews_en[reviewIdx],
          formatted: reviews_ja[reviewIdx],
          replied: Math.random() > 0.5 // ランダムに返信済みフラグを設定
        });
      }

      return reviews.sort((a, b) => new Date(b.date) - new Date(a.date));
    }

    function initializeMonthFilter() {
      const select = document.getElementById('month-filter');
      const options = [];
      const now = new Date();

      // 過去6ヶ月分の選択肢を生成
      for (let i = 0; i < 6; i++) {
        const date = new Date(now.getFullYear(), now.getMonth() - i, 1);
        const year = date.getFullYear();
        const month = date.getMonth() + 1;
        const value = `${year}-${String(month).padStart(2, '0')}`;
        const label = `${year}年${month}月`;
        options.push({ value, label });
      }

      select.innerHTML = options.map(opt =>
        `<option value="${opt.value}">${opt.label}</option>`
      ).join('');
    }

    function filterByMonth() {
      const selectedMonth = document.getElementById('month-filter').value;
      renderReviews(selectedMonth);
    }

    function getScoreColor(score) {
      if (score >= 80) return 'text-green-600 font-bold';
      if (score >= 60) return 'text-blue-600 font-semibold';
      if (score >= 40) return 'text-yellow-600 font-semibold';
      return 'text-red-600 font-bold';
    }

    function getScoreBgColor(score) {
      if (score >= 80) return 'bg-green-50';
      if (score >= 60) return 'bg-blue-50';
      if (score >= 40) return 'bg-yellow-50';
      return 'bg-red-50';
    }

    function truncateText(text, maxLength) {
      if (text.length <= maxLength) return text;
      return text.substring(0, maxLength) + '...';
    }

    function renderReviews(selectedMonth = null) {
      const facilityName = document.querySelector('.text-3xl.font-bold.mb-2')?.textContent || 'Minn 日本橋';

      // 初回または全データ生成が必要な場合
      if (allReviews.length === 0) {
        allReviews = generateMockReviews(50, facilityName, 6);
      }

      // 選択された月がない場合は当月を使用
      if (!selectedMonth) {
        const now = new Date();
        selectedMonth = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
      }

      // 選択月のレビューをフィルタリング
      const mockReviews = allReviews.filter(review => {
        return review.date.startsWith(selectedMonth);
      });

      // 前月のレビューを取得（比較用）
      const [year, month] = selectedMonth.split('-').map(Number);
      const prevDate = new Date(year, month - 2, 1); // -2 because month is 1-indexed
      const prevMonth = `${prevDate.getFullYear()}-${String(prevDate.getMonth() + 1).padStart(2, '0')}`;
      const prevMonthReviews = allReviews.filter(review => review.date.startsWith(prevMonth));

      const tbody = document.getElementById('reviews-tbody');
      let html = '';

      mockReviews.forEach((review) => {
        html += `
          <tr class="hover:bg-gray-50 transition-colors ${getScoreBgColor(review.score)}">
            <td class="px-3 py-2 whitespace-nowrap text-xs text-gray-600">${review.id}</td>
            <td class="px-3 py-2 whitespace-nowrap text-xs text-gray-900">${review.date}</td>
            <td class="px-3 py-2 whitespace-nowrap text-xs font-medium text-gray-900">${review.facility}</td>
            <td class="px-3 py-2 whitespace-nowrap text-center">
              <span class="text-sm ${getScoreColor(review.score)}">${review.score}</span>
            </td>
            <td class="px-3 py-2 whitespace-nowrap text-xs text-gray-600">${review.site}</td>
            <td class="px-3 py-2 text-xs text-gray-900" style="max-width: 200px;">
              <div class="font-semibold truncate">${review.title}</div>
            </td>
            <td class="px-3 py-2 text-xs text-gray-700" style="max-width: 250px;">
              <div style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                ${review.translation}
              </div>
            </td>
            <td class="px-3 py-2 text-xs text-gray-700" style="max-width: 250px;">
              <div style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                ${review.original}
              </div>
            </td>
            <td class="px-3 py-2 whitespace-nowrap text-center">
              <input type="checkbox" ${review.replied ? 'checked' : ''} onchange="toggleReplied('${review.id}')" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 cursor-pointer">
            </td>
            <td class="px-3 py-2 whitespace-nowrap">
              <input type="text" value="${review.name}" onchange="updateName('${review.id}', this.value)" class="w-full px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500" style="min-width: 100px;">
            </td>
          </tr>
        `;
      });

      tbody.innerHTML = html;

      // 統計を更新
      const avgScore = mockReviews.length > 0
        ? mockReviews.reduce((sum, r) => sum + r.score, 0) / mockReviews.length
        : 0;
      const highReviews = mockReviews.filter(r => r.score >= 90).length;
      const lowReviews = mockReviews.filter(r => r.score < 60).length;

      // 前月の統計を計算
      const prevAvgScore = prevMonthReviews.length > 0
        ? prevMonthReviews.reduce((sum, r) => sum + r.score, 0) / prevMonthReviews.length
        : 0;
      const prevHighReviews = prevMonthReviews.filter(r => r.score >= 90).length;
      const prevLowReviews = prevMonthReviews.filter(r => r.score < 60).length;

      // 前月比を計算
      const totalDiff = mockReviews.length - prevMonthReviews.length;
      const totalPercent = prevMonthReviews.length > 0
        ? ((totalDiff / prevMonthReviews.length) * 100).toFixed(1)
        : '0.0';
      const avgDiff = (avgScore - prevAvgScore).toFixed(1);
      const highDiff = highReviews - prevHighReviews;
      const highPercent = prevHighReviews > 0
        ? ((highDiff / prevHighReviews) * 100).toFixed(1)
        : '0.0';
      const lowDiff = lowReviews - prevLowReviews;
      const lowPercent = prevLowReviews > 0
        ? ((lowDiff / prevLowReviews) * 100).toFixed(1)
        : '0.0';

      document.getElementById('total-reviews').textContent = mockReviews.length;
      document.getElementById('avg-score').textContent = avgScore.toFixed(1);
      document.getElementById('high-reviews').textContent = highReviews;
      document.getElementById('low-reviews').textContent = lowReviews;

      // 前月比を表示
      document.getElementById('total-reviews-diff').innerHTML =
        prevMonthReviews.length > 0
          ? `<span class="${totalDiff >= 0 ? 'text-green-600' : 'text-red-600'}">${totalDiff >= 0 ? '↑' : '↓'} ${totalDiff >= 0 ? '+' : ''}${totalDiff} (${totalPercent}%)</span>`
          : '<span class="text-gray-500">-</span>';
      document.getElementById('avg-score-diff').innerHTML =
        prevMonthReviews.length > 0
          ? `<span class="${avgDiff >= 0 ? 'text-green-600' : 'text-red-600'}">${avgDiff >= 0 ? '↑' : '↓'} ${avgDiff >= 0 ? '+' : ''}${avgDiff}pt</span>`
          : '<span class="text-gray-500">-</span>';
      document.getElementById('high-reviews-diff').innerHTML =
        prevHighReviews > 0
          ? `<span class="${highDiff >= 0 ? 'text-green-600' : 'text-red-600'}">${highDiff >= 0 ? '↑' : '↓'} ${highDiff >= 0 ? '+' : ''}${highDiff} (${highPercent}%)</span>`
          : '<span class="text-gray-500">-</span>';
      document.getElementById('low-reviews-diff').innerHTML =
        prevLowReviews >= 0
          ? `<span class="${lowDiff >= 0 ? 'text-red-600' : 'text-green-600'}">${lowDiff >= 0 ? '↑' : '↓'} ${lowDiff >= 0 ? '+' : ''}${lowDiff} (${lowPercent}%)</span>`
          : '<span class="text-gray-500">-</span>';

      document.getElementById('displayed-count').textContent = mockReviews.length;
      document.getElementById('total-count').textContent = mockReviews.length;
    }

    function previousPage() {
      if (currentReviewPage > 1) {
        currentReviewPage--;
        renderReviews();
      }
    }

    function nextPage() {
      currentReviewPage++;
      renderReviews();
    }

    function toggleReplied(reviewId) {
      // 返信済みチェックボックスの状態を切り替え
      const review = allReviews.find(r => r.id === reviewId);
      if (review) {
        review.replied = !review.replied;
        console.log(`Review ${reviewId} replied status: ${review.replied}`);
      }
    }

    function updateName(reviewId, newName) {
      // レビューの名前を更新
      const review = allReviews.find(r => r.id === reviewId);
      if (review) {
        review.name = newName;
        console.log(`Review ${reviewId} name updated to: ${newName}`);
      }
    }

    // クレームデータ生成
    let allComplaints = [];
    let currentComplaintPage = 1;
    const complaintsPerPage = 10;

    function generateMockComplaintData() {
      const roomNames = ['桜', '梅', '松', '竹', '菊', '藤', '蘭', '椿', '桔梗', '楓', '牡丹', '菖蒲', '百合', '紅葉', '桐', '蓮', '柳', '杉', '檜', '欅'];
      const guests = ['田中様', '鈴木様', '高橋様', '渡辺様', '小林様', '佐藤様', '山田様', '中村様', '伊藤様', '斉藤様'];
      const sources = ['電話', 'メール', '直接', 'Booking.com', '楽天トラベル'];
      const titles = [
        'エアコン不調',
        'アレルギー対応依頼',
        '騒音苦情',
        'チェックイン遅延',
        'Wi-Fi接続不良',
        'タオル未交換',
        'シャワー水圧問題',
        '冷蔵庫故障',
        '清掃不備',
        '駐車場案内不明'
      ];
      const contents = [
        'エアコンの調子が悪く、部屋が寒いとのご連絡',
        '朝食のメニューについてアレルギー対応の問い合わせ',
        '隣室の騒音について苦情',
        'チェックイン時の対応が遅かったとの指摘',
        'Wi-Fiの接続が不安定',
        'タオルの交換がされていない',
        'シャワーの水圧が弱い',
        '冷蔵庫が作動していない',
        '清掃が不十分とのご指摘',
        '駐車場の案内が不明確'
      ];
      const responses = [
        '即座に確認し、エアコンを修理。代替ヒーターを提供',
        'アレルギー対応メニューを別途用意し、事前にご案内',
        '隣室に注意喚起。お客様には別室への移動を提案',
        '謝罪し、次回利用時のサービス向上を約束',
        'ルーターを再起動し、接続状況を改善',
        '即座にタオルを交換し、謝罪',
        '設備チームが確認し、調整を実施',
        '新しい冷蔵庫に交換',
        '再度清掃を実施し、確認をいただく',
        '駐車場の案内表示を改善'
      ];
      const staffs = ['佐藤', '山田', '伊藤', '中村', '田中', '鈴木'];
      const statuses = ['対応完了', '対応完了', '対応完了', '対応中', '対応完了'];

      const complaints = [];
      for (let i = 0; i < 50; i++) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        const dateStr = `${date.getFullYear()}/${String(date.getMonth() + 1).padStart(2, '0')}/${String(date.getDate()).padStart(2, '0')} ${String(Math.floor(Math.random() * 24)).padStart(2, '0')}:${String(Math.floor(Math.random() * 60)).padStart(2, '0')}`;

        const idx = Math.floor(Math.random() * contents.length);
        complaints.push({
          datetime: dateStr,
          roomName: roomNames[Math.floor(Math.random() * roomNames.length)],
          guestName: guests[Math.floor(Math.random() * guests.length)],
          source: sources[Math.floor(Math.random() * sources.length)],
          title: titles[idx],
          content: contents[idx],
          response: responses[idx],
          staff: staffs[Math.floor(Math.random() * staffs.length)],
          status: statuses[Math.floor(Math.random() * statuses.length)]
        });
      }
      return complaints;
    }

    function renderComplaintData() {
      if (allComplaints.length === 0) {
        allComplaints = generateMockComplaintData();
      }

      const tbody = document.getElementById('complaints-tbody');
      if (!tbody) return;

      const startIdx = (currentComplaintPage - 1) * complaintsPerPage;
      const endIdx = startIdx + complaintsPerPage;
      const pageComplaints = allComplaints.slice(startIdx, endIdx);

      tbody.innerHTML = pageComplaints.map((complaint, idx) => {
        const statusColor = complaint.status === '対応完了' ? 'text-green-600' :
                           complaint.status === '対応中' ? 'text-orange-600' : 'text-gray-600';
        const bgColor = idx % 2 === 0 ? 'bg-white' : 'bg-gray-50';
        const globalIdx = startIdx + idx;

        return `
          <tr class="hover:bg-gray-100 transition-colors ${bgColor}">
            <td class="px-3 py-2 whitespace-nowrap text-xs text-gray-900">${complaint.datetime}</td>
            <td class="px-3 py-2 whitespace-nowrap text-xs text-gray-900">${complaint.roomName}</td>
            <td class="px-3 py-2 whitespace-nowrap text-xs text-gray-600">${complaint.source}</td>
            <td class="px-3 py-2 text-xs text-gray-900 font-semibold">${complaint.title || '-'}</td>
            <td class="px-3 py-2 text-xs text-gray-700">${complaint.content}</td>
            <td class="px-3 py-2 text-xs text-gray-700">${complaint.response}</td>
            <td class="px-3 py-2 whitespace-nowrap text-xs text-gray-900">${complaint.staff}</td>
            <td class="px-3 py-2 whitespace-nowrap text-xs ${statusColor} font-semibold">${complaint.status}</td>
            <td class="px-3 py-2 text-center">
              <button onclick="openComplaintEditModal(${globalIdx})" class="bg-blue-600 text-white px-3 py-1 rounded text-xs hover:bg-blue-700">
                入力
              </button>
            </td>
          </tr>
        `;
      }).join('');

      // ページネーション情報を更新
      document.getElementById('complaint-displayed-count').textContent = pageComplaints.length;
      document.getElementById('complaint-total-count').textContent = allComplaints.length;
      document.getElementById('complaint-current-page').textContent = currentComplaintPage;
    }

    function changeComplaintPage(direction) {
      const totalPages = Math.ceil(allComplaints.length / complaintsPerPage);
      const newPage = currentComplaintPage + direction;

      if (newPage >= 1 && newPage <= totalPages) {
        currentComplaintPage = newPage;
        renderComplaintData();
      }
    }

    function filterComplaints() {
      const dateFrom = document.getElementById('complaint-date-from').value;
      const dateTo = document.getElementById('complaint-date-to').value;

      if (!dateFrom || !dateTo) {
        alert('開始日と終了日を両方選択してください');
        return;
      }

      const originalComplaints = generateMockComplaintData();
      allComplaints = originalComplaints.filter(complaint => {
        const complaintDate = new Date(complaint.datetime.split(' ')[0]);
        const fromDate = new Date(dateFrom);
        const toDate = new Date(dateTo);
        return complaintDate >= fromDate && complaintDate <= toDate;
      });

      currentComplaintPage = 1;
      renderComplaintData();
    }

    function openComplaintModal() {
      const modal = document.getElementById('complaintModal');
      if (modal) {
        modal.style.display = 'flex';
      }
    }

    function closeComplaintModal() {
      const modal = document.getElementById('complaintModal');
      if (modal) {
        modal.style.display = 'none';
        const form = document.getElementById('complaintForm');
        if (form) {
          form.reset();
        }
      }
    }

    function openComplaintEditModal(index) {
      // 選択されたクレームデータを取得
      const complaint = allComplaints[index];
      if (!complaint) return;

      // フォームフィールドに値を設定
      document.getElementById('complaint-status').value = complaint.status || '対応中';
      document.getElementById('complaint-title').value = complaint.title || '';
      document.getElementById('complaint-source').value = complaint.source || '';
      document.getElementById('complaint-room').value = complaint.roomName || '';
      document.getElementById('complaint-staff').value = complaint.staff || '';
      document.getElementById('complaint-content').value = complaint.content || '';
      document.getElementById('complaint-response').value = complaint.response || '';
      document.getElementById('complaint-cause').value = complaint.cause || '';
      document.getElementById('complaint-improvement').value = complaint.improvement || '';

      // モーダルを開く
      openComplaintModal();
    }

    // パフォーマンスデータ生成
    function generateMockPerformanceData() {
      const facility = 'Minn 日本橋';
      const performanceData = [];
      const previousMonthAvg = {trustyou: 85, google: 8, booking: 12, expedia: 6, tripcom: 10, agoda: 8, rakuten: 15, jalan: 13, airbnb: 5};

      // 過去14日分のデータを生成（1日1レコード）
      for (let i = 0; i < 14; i++) {
        const date = new Date();
        date.setDate(date.getDate() - i);
        const dateStr = date.toLocaleDateString('ja-JP');

        const trustYouActual = Math.floor(Math.random() * 30) + 70;
        const record = {
          date: dateStr,
          facility: facility,
          trustYouPerformance: trustYouActual,
          trustYouDiff: trustYouActual - previousMonthAvg.trustyou,
          lowRatingCount: Math.floor(Math.random() * 5),
          sites: {
            google: {actual: Math.floor(Math.random() * 10), diff: Math.floor(Math.random() * 10) - previousMonthAvg.google},
            booking: {actual: Math.floor(Math.random() * 15), diff: Math.floor(Math.random() * 15) - previousMonthAvg.booking},
            expedia: {actual: Math.floor(Math.random() * 8), diff: Math.floor(Math.random() * 8) - previousMonthAvg.expedia},
            tripcom: {actual: Math.floor(Math.random() * 12), diff: Math.floor(Math.random() * 12) - previousMonthAvg.tripcom},
            agoda: {actual: Math.floor(Math.random() * 10), diff: Math.floor(Math.random() * 10) - previousMonthAvg.agoda},
            rakuten: {actual: Math.floor(Math.random() * 18), diff: Math.floor(Math.random() * 18) - previousMonthAvg.rakuten},
            jalan: {actual: Math.floor(Math.random() * 16), diff: Math.floor(Math.random() * 16) - previousMonthAvg.jalan},
            airbnb: {actual: Math.floor(Math.random() * 6), diff: Math.floor(Math.random() * 6) - previousMonthAvg.airbnb}
          }
        };
        performanceData.push(record);
      }
      return performanceData;
    }
    function formatDiff(diff) { return diff > 0 ? `+${diff}` : `${diff}`; }
    function getDiffColor(diff) { return diff > 0 ? 'text-red-600' : diff < 0 ? 'text-blue-600' : 'text-gray-600'; }

    function renderPerformanceData() {
      const performanceData = generateMockPerformanceData();
      const tbody = document.getElementById('performance-tbody');

      if (!tbody) return;

      tbody.innerHTML = performanceData.map((record, idx) => {
        const perfScore = record.trustYouPerformance;
        const bgColor = idx % 2 === 0 ? 'bg-blue-50' : 'bg-white';

        return `
          <tr class="hover:bg-gray-100 transition-colors ${bgColor}">
            <td class="px-3 py-2 whitespace-nowrap text-xs text-gray-900 border-r border-gray-200 sticky left-0 z-10 ${bgColor}">${record.date}</td>
            <td class="px-3 py-2 whitespace-nowrap text-xs font-medium text-gray-900 border-r border-gray-200 sticky left-[100px] z-10 ${bgColor}">${record.facility}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs text-gray-900 border-r border-gray-200">${perfScore}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs ${getDiffColor(record.trustYouDiff)} border-r border-gray-200">${formatDiff(record.trustYouDiff)}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs text-gray-900 border-r border-gray-200">${record.sites.google.actual}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs ${getDiffColor(record.sites.google.diff)} border-r border-gray-200">${formatDiff(record.sites.google.diff)}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs text-gray-900 border-r border-gray-200">${record.sites.booking.actual}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs ${getDiffColor(record.sites.booking.diff)} border-r border-gray-200">${formatDiff(record.sites.booking.diff)}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs text-gray-900 border-r border-gray-200">${record.sites.expedia.actual}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs ${getDiffColor(record.sites.expedia.diff)} border-r border-gray-200">${formatDiff(record.sites.expedia.diff)}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs text-gray-900 border-r border-gray-200">${record.sites.tripcom.actual}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs ${getDiffColor(record.sites.tripcom.diff)} border-r border-gray-200">${formatDiff(record.sites.tripcom.diff)}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs text-gray-900 border-r border-gray-200">${record.sites.agoda.actual}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs ${getDiffColor(record.sites.agoda.diff)} border-r border-gray-200">${formatDiff(record.sites.agoda.diff)}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs text-gray-900 border-r border-gray-200">${record.sites.rakuten.actual}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs ${getDiffColor(record.sites.rakuten.diff)} border-r border-gray-200">${formatDiff(record.sites.rakuten.diff)}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs text-gray-900 border-r border-gray-200">${record.sites.jalan.actual}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs ${getDiffColor(record.sites.jalan.diff)} border-r border-gray-200">${formatDiff(record.sites.jalan.diff)}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs text-gray-900 border-r border-gray-200">${record.sites.airbnb.actual}</td>
            <td class="px-2 py-2 whitespace-nowrap text-center text-xs ${getDiffColor(record.sites.airbnb.diff)}">${formatDiff(record.sites.airbnb.diff)}</td>
          </tr>
        `;
      }).join('');

      // 表示件数を更新
      const displayedCount = document.getElementById('performance-displayed-count');
      if (displayedCount) {
        displayedCount.textContent = performanceData.length;
      }
    }

    // ページ読み込み時に今日の日付を設定
    document.addEventListener('DOMContentLoaded', function() {
      setToday();
      initializeMonthFilter();
      renderReviews();
      renderComplaintData();
      renderPerformanceData();
    });
  </script>
</body>
</html>
